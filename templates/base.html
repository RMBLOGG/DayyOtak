<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="pTKv7RdKpXBtLCnGaf4YM9U_aXpx4uzHnyL2mm3Kn3s" />
    <meta name="description" content="DAYYdesu - Nonton Anime Sub Indo">
    <meta property="og:title" content="DAYYdesu">
    <meta property="og:site_name" content="DAYYdesu">
    <meta property="og:description" content="Nonton Anime Sub Indo">
    <title>{% block title %}DayyDesu{% endblock %}</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% block extra_css %}{% endblock %}
    <style>
        /* Hanya geser elemen fixed yang kecil (tombol), bukan popup besar */
        body > div[style*="fixed"],
        body > div[style*="position: fixed"],
        body > div[style*="position:fixed"] {
            bottom: 65px !important;
        }
    </style>
</head>
<body>
    <!-- Main Content -->
    <div class="main-content">
        <!-- Top Navigation Bar -->
        <header class="topbar">
            <div class="topbar-logo">
                <div class="logo-icon">
                    <i class="fas fa-play"></i>
                </div>
                <div class="logo-title">ğ˜¿ğ˜¼ğ™”ğ™”ğ™™ğ™šğ™¨ğ™ª</div>
            </div>
            
            <div class="search-wrapper">
                <form action="/search" method="get" class="search-form" onsubmit="searchAnime(event)">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" name="q" class="search-input" placeholder="Cari anime..." required>
                </form>
            </div>
            
            <div class="topbar-actions">
                <button class="action-btn notification-btn" id="notificationBtn">
                    <i class="fas fa-bell"></i>
                    <span class="badge">3</span>
                </button>
            </div>
        </header>
        
        <!-- Page Content -->
        <main class="content-wrapper">
            {% block content %}{% endblock %}
        </main>
    </div>
    
    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="bottom-nav-item">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a href="/ongoing" class="bottom-nav-item">
            <i class="fas fa-fire"></i>
            <span>Ongoing</span>
        </a>
        <a href="/completed" class="bottom-nav-item">
            <i class="fas fa-check-circle"></i>
            <span>Complete</span>
        </a>
        <a href="/bookmarks" class="bottom-nav-item">
            <i class="fas fa-bookmark"></i>
            <span>Bookmark</span>
            <span class="nav-badge" id="bottomBookmarkCount" style="display: none;">0</span>
        </a>
        <button class="bottom-nav-item" id="menuBtn">
            <i class="fas fa-bars"></i>
            <span>Menu</span>
        </button>
    </nav>

    <!-- Menu Modal -->
    <div class="menu-overlay" id="menuOverlay"></div>
    <div class="menu-modal" id="menuModal">
        <div class="menu-modal-content">
            <div class="menu-modal-header">
                <div class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-play"></i>
                    </div>
                    <div class="logo-text">
                        <div class="logo-title">ğ˜¿ğ˜¼ğ™”ğ™”ğ™™ğ™šğ™¨ğ™ª</div>
                        <div class="logo-subtitle">Nonton Anime Sub Indo</div>
                    </div>
                </div>
                <button class="menu-close" id="menuClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="menu-modal-body">
                <div class="menu-section">
                    <div class="menu-section-title">Browse</div>
                    <a href="/all-anime" class="menu-item">
                        <i class="fas fa-list"></i>
                        <span>All Anime</span>
                    </a>
                    <a href="/genres" class="menu-item">
                        <i class="fas fa-theater-masks"></i>
                        <span>Genres</span>
                    </a>
                    <a href="/schedule" class="menu-item">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Schedule</span>
                    </a>
                </div>
                
                <div class="menu-section">
                    <div class="menu-section-title">Settings</div>
                    <div class="menu-item theme-toggle" id="themeToggleMenu">
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <i class="fas fa-moon"></i>
                            <span>Dark Mode</span>
                        </div>
                        <div class="toggle-switch">
                            <input type="checkbox" id="themeCheckbox">
                            <label for="themeCheckbox"></label>
                        </div>
                    </div>
                </div>

                <!-- Footer di dalam Menu Modal -->
                <div class="menu-section">
                    <div class="menu-section-title">Connect With Us</div>
                    <div class="menu-footer">
                        <div class="social-links-menu">
                            <a href="https://www.instagram.com/rmdnhdyh20_?igsh=bnR2c25yd3lqaDFk" target="_blank" class="social-link-item">
                                <i class="fab fa-instagram"></i>
                                <span>Instagram</span>
                            </a>
                            <a href="https://discord.gg/CEb5xgMQm" target="_blank" class="social-link-item">
                                <i class="fab fa-discord"></i>
                                <span>Discord</span>
                            </a>
                            <a href="https://www.facebook.com/4Dayy" target="_blank" class="social-link-item">
                                <i class="fab fa-facebook"></i>
                                <span>Facebook</span>
                            </a>
                        </div>
                        <div class="copyright-text">
                            <p>&copy; 2026 ğ˜¿ğ˜¼ğ™”ğ™”ğ™™ğ™šğ™¨ğ™ª. All rights reserved.</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="menu-modal-footer">
                <div class="version">Version 2.0.0</div>
            </div>
        </div>
    </div>
    
    <!-- Notification Dropdown -->
<!--     <div class="notification-dropdown" id="notificationDropdown">
        <div class="notification-header">
            <h3>Notifikasi</h3>
            <button class="notification-close" id="notificationClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-list">
            <div class="notification-item unread">
                <div class="notification-icon">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Episode Baru Tersedia</div>
                    <div class="notification-text">Episode terbaru sudah rilis!</div>
                    <div class="notification-time">5 menit yang lalu</div>
                </div>
            </div>
            <div class="notification-item unread">
                <div class="notification-icon">
                    <i class="fas fa-star"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Trending Minggu Ini</div>
                    <div class="notification-text">Lihat anime populer minggu ini</div>
                    <div class="notification-time">2 jam yang lalu</div>
                </div>
            </div>
            <div class="notification-item unread">
                <div class="notification-icon">
                    <i class="fas fa-calendar"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Jadwal Update</div>
                    <div class="notification-text">Anime baru dijadwalkan hari ini</div>
                    <div class="notification-time">5 jam yang lalu</div>
                </div>
            </div>
            <div class="notification-item">
                <div class="notification-icon">
                    <i class="fas fa-heart"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">Rekomendasi</div>
                    <div class="notification-text">Berdasarkan riwayat tontonan kamu...</div>
                    <div class="notification-time">1 hari yang lalu</div>
                </div>
            </div>
        </div>
        <div class="notification-footer">
            <a href="#" class="notification-clear">Hapus semua notifikasi</a>
        </div>
    </div> -->
    
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        // Theme Toggle Function
        function initThemeToggle() {
            const themeToggleMenu = document.getElementById('themeToggleMenu');
            const themeCheckbox = document.getElementById('themeCheckbox');
            const body = document.body;
            
            // Check for saved theme preference or default to dark mode
            const currentTheme = localStorage.getItem('theme') || 'dark';
            
            // Apply saved theme
            if (currentTheme === 'light') {
                body.classList.add('light-theme');
                if (themeCheckbox) {
                    themeCheckbox.checked = true;
                }
            }
            
            // Function to update theme
            function updateTheme(isLight) {
                if (isLight) {
                    body.classList.add('light-theme');
                } else {
                    body.classList.remove('light-theme');
                }
                
                // Update checkbox if exists
                if (themeCheckbox) {
                    themeCheckbox.checked = isLight;
                }
                
                // Save preference
                const theme = isLight ? 'light' : 'dark';
                localStorage.setItem('theme', theme);
                
                // Update icon and text in theme toggle
                const icon = themeToggleMenu?.querySelector('i');
                const text = themeToggleMenu?.querySelector('span');
                if (icon && text) {
                    if (isLight) {
                        icon.className = 'fas fa-sun';
                        text.textContent = 'Light Mode';
                    } else {
                        icon.className = 'fas fa-moon';
                        text.textContent = 'Dark Mode';
                    }
                }
            }
            
            // Theme toggle event listener
            if (themeToggleMenu) {
                themeToggleMenu.addEventListener('click', function(e) {
                    // Don't toggle if clicking on the checkbox itself
                    if (e.target === themeCheckbox) return;
                    
                    const newTheme = !body.classList.contains('light-theme');
                    updateTheme(newTheme);
                });
            }
            
            // Checkbox toggle event
            if (themeCheckbox) {
                themeCheckbox.addEventListener('change', function() {
                    updateTheme(this.checked);
                });
            }
            
            // Update initial icon and text based on current theme
            const icon = themeToggleMenu?.querySelector('i');
            const text = themeToggleMenu?.querySelector('span');
            if (icon && text) {
                if (currentTheme === 'light') {
                    icon.className = 'fas fa-sun';
                    text.textContent = 'Light Mode';
                } else {
                    icon.className = 'fas fa-moon';
                    text.textContent = 'Dark Mode';
                }
            }
        }
        
        // Load bookmark count on page load
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize theme toggle
            initThemeToggle();
            
            // Load bookmark count
            try {
                const response = await fetch('/api/bookmarks');
                const result = await response.json();
                
                if (result.status === 'success') {
                    const count = result.data.count;
                    const badge = document.getElementById('bottomBookmarkCount');
                    
                    if (count > 0 && badge) {
                        badge.textContent = count > 99 ? '99+' : count;
                        badge.style.display = 'flex';
                    }
                }
            } catch (error) {
                console.error('Error loading bookmark count:', error);
            }
        });
    </script>

    {% block extra_js %}{% endblock %}
    
    <script src="https://pl28657674.effectivegatecpm.com/8e/73/23/8e73236a6460c851945d5d5649c0fb70.js"></script>
    <script type="text/javascript" src="https://storage.sociabuzz.com/storage/js/main/buttononwebsite/index.min.js"></script>
    <script>sbBoW.draw("dayynime","QmVyaSBEdWt1bmdhbg","position-bottom-right","#3b82f6","#FFFFFF")</script>
    <script>
        // Fix posisi tombol SociaBuzz
        // Hanya geser elemen fixed yang KECIL (tombol), bukan popup/modal besar
        function fixSociabuzzBtn() {
            document.querySelectorAll('body > *').forEach(function(el) {
                // Skip elemen milik kita
                if (el.tagName === 'SCRIPT' || el.tagName === 'NAV' ||
                    el.classList.contains('main-content') ||
                    el.classList.contains('bottom-nav') ||
                    el.classList.contains('menu-modal') ||
                    el.classList.contains('menu-overlay')) return;

                var cs = window.getComputedStyle(el);
                if (cs.position !== 'fixed') return;

                // Cek ukuran elemen â€” hanya geser jika KECIL (tombol, bukan popup)
                var rect = el.getBoundingClientRect();
                var isSmallButton = rect.width < 300 && rect.height < 120;

                if (isSmallButton) {
                    // Hanya geser bottom, jangan ganggu left/right
                    el.style.setProperty('bottom', '65px', 'important');
                }
                // Popup besar (form donasi) dibiarkan, jadi tetap di tengah
            });
        }
        [200, 600, 1200, 2500].forEach(function(t) { setTimeout(fixSociabuzzBtn, t); });

        // Fix menu buka/tutup
        (function() {
            function initMenu() {
                var menuBtn     = document.getElementById('menuBtn');
                var menuClose   = document.getElementById('menuClose');
                var menuOverlay = document.getElementById('menuOverlay');
                var menuModal   = document.getElementById('menuModal');
                if (!menuBtn || !menuClose || !menuOverlay || !menuModal) return;
                function openMenu() {
                    menuModal.classList.add('active');
                    menuOverlay.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }
                function closeMenu() {
                    menuModal.classList.remove('active');
                    menuOverlay.classList.remove('active');
                    document.body.style.overflow = '';
                }
                var newBtn   = menuBtn.cloneNode(true);
                var newClose = menuClose.cloneNode(true);
                menuBtn.parentNode.replaceChild(newBtn, menuBtn);
                menuClose.parentNode.replaceChild(newClose, menuClose);
                newBtn.addEventListener('click', openMenu);
                newClose.addEventListener('click', closeMenu);
                menuOverlay.addEventListener('click', closeMenu);
                document.addEventListener('keydown', function(e) { if (e.key === 'Escape') closeMenu(); });
            }
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initMenu);
            } else { initMenu(); }
        })();

        window.addEventListener('beforeinstallprompt', function(e) { e.preventDefault(); });
    </script>
</body>
</html>
